<div class="app-container">
  <!-- Confetti Animation -->
  <div *ngIf="showConfetti" class="confetti-container">
    <div class="confetti" *ngFor="let i of [].constructor(50); let idx = index" [style.animation-delay.s]="idx * 0.1"></div>
  </div>

  <div class="game-status">
    <div *ngIf="!isGameOver">
      <!-- Top row with question progress -->
      <div class="question-progress">
        <span>שאלה {{ correctAnswers + wrongAnswers + 1 }} מתוך {{ totalQuestions }}</span>
      </div>
      
      <!-- Main indicators row -->
      <div class="main-indicators">
        <div class="indicator time-indicator">
          <div class="indicator-icon">⏰</div>
          <div class="indicator-value">{{ timeLeft }}</div>
          <div class="indicator-label">שניות</div>
        </div>
        
        <div class="indicator score-indicator">
          <div class="indicator-icon">⭐</div>
          <div class="indicator-value">{{ score }}</div>
          <div class="indicator-label">נקודות</div>
        </div>
        
        <div class="indicator mistakes-indicator">
          <div class="indicator-icon">❌</div>
          <div class="indicator-value">{{ maxFailures - wrongAnswers }}</div>
          <div class="indicator-label">טעויות נותרות</div>
        </div>
      </div>
      
      <!-- Hints indicator -->
      <div class="hints-indicator">
        <span>💡 רמזים נותרים: {{ hintsLeft }}</span>
      </div>
      
      <!-- New Game and Hall of Fame buttons during gameplay -->
      <div class="new-game-section">
        <button (click)="newGame()" class="new-game-button">🔄 משחק חדש</button>
        <button (click)="showHallOfFame()" class="hall-of-fame-button">🏆 היכל התהילה</button>
      </div>
    </div>
    
    <div *ngIf="isGameOver">
      <h1>{{ resultMessage }}</h1>
      
      <!-- Player name input section -->
      <div *ngIf="showNameInput" class="name-input-section">
        <h3>🌟 בואי נשמור את הציון המגניב שלך!</h3>
        <div class="name-input-form">
          <input #playerNameInput type="text" [(ngModel)]="playerName" 
                 placeholder="איך קוראים לך? 😊" 
                 (keydown.enter)="onPlayerNameSubmit()" 
                 maxlength="20" />
          <div class="name-buttons">
            <button (click)="saveScore()" [disabled]="!playerName.trim()">💾 שמרי ציון</button>
            <button (click)="skipSaveScore()" class="skip-button">🚀 דלגי</button>
          </div>
        </div>
      </div>

      <!-- Leaderboard section -->
      <div *ngIf="showLeaderboard" class="leaderboard-section">
        <h3>🏆 הכוכבות הכי מגניבות - טופ 10!</h3>
        <div class="leaderboard" *ngIf="topScores.length > 0">
          <div class="score-entry" *ngFor="let entry of topScores; let i = index" 
               [ngClass]="{'current-player': entry.name === playerName && entry.score === score}">
            <div class="rank">{{ i + 1 }}</div>
            <div class="player-info">
              <div class="name">{{ entry.name }}</div>
              <div class="details">{{ entry.correctAnswers }}/{{ entry.totalQuestions }} • {{ entry.date }}</div>
            </div>
            <div class="score">{{ entry.score }}</div>
          </div>
        </div>
        <div *ngIf="topScores.length === 0" class="no-scores">
          עוד אין כוכבות כאן... את יכולה להיות הראשונה! ✨
        </div>
        <button (click)="hideLeaderboard()">🎮 בואי נמשיך</button>
      </div>

      <!-- Game over buttons (shown when not in name input or leaderboard) -->
      <div *ngIf="!showNameInput && !showLeaderboard" class="game-over-buttons">
        <button (click)="startGame()" class="play-again-button">🎯 בואי נשחק שוב!</button>
      </div>
    </div>
  </div>

  <!-- Feedback Animation Overlay -->
  <div *ngIf="showFeedback" class="feedback-overlay" 
       [ngClass]="{'correct-feedback': feedbackType === 'correct', 'wrong-feedback': feedbackType === 'wrong'}">
    <div class="feedback-content">
      <div class="feedback-icon">
        <span *ngIf="feedbackType === 'correct'">🎉</span>
        <span *ngIf="feedbackType === 'wrong'">❌</span>
      </div>
      <div class="feedback-message">{{ feedbackMessage }}</div>
    </div>
  </div>

  <!-- Hall of Fame Overlay (during gameplay) -->
  <div *ngIf="showHallOfFameOverlay" class="hall-of-fame-overlay">
    <div class="hall-of-fame-content">
      <h3>🏆 היכל התהילה - הכוכבות הכי מגניבות!</h3>
      <div class="leaderboard" *ngIf="topScores.length > 0">
        <div class="score-entry" *ngFor="let entry of topScores; let i = index">
          <div class="rank">{{ i + 1 }}</div>
          <div class="player-info">
            <div class="name">{{ entry.name }}</div>
            <div class="details">{{ entry.correctAnswers }}/{{ entry.totalQuestions }} • {{ entry.date }}</div>
          </div>
          <div class="score">{{ entry.score }}</div>
        </div>
      </div>
      <div *ngIf="topScores.length === 0" class="no-scores">
        עוד אין כוכבות כאן... את יכולה להיות הראשונה! ✨
      </div>
      <button (click)="hideHallOfFame()" class="close-hall-button">❌ סגרי</button>
    </div>
  </div>

  <div *ngIf="!isGameOver" class="question" [ngClass]="{'answering': isAnswering}">
    <h2 dir="ltr">{{ currentQuestion?.question }}</h2>
    
    <!-- Hint section -->
    <div class="hint-section">
      <button (click)="useHint()" [disabled]="hintsLeft === 0 || hintUsed || isAnswering" class="hint-button">
        💡 השתמשי ברמז ({{ hintsLeft }} נותרים)
      </button>
      <div *ngIf="currentHint" class="hint-display">
        {{ currentHint }}
      </div>
    </div>
    
    <input #userAnswerInput type="number" [(ngModel)]="userAnswer" placeholder="התשובה שלך" 
           (keydown.enter)="onSubmitAnswer()"  />
    <button (click)="onSubmitAnswer()" [disabled]="isAnswering || userAnswer === undefined">
      {{ isAnswering ? 'מעבדת...' : 'שלחי' }}
    </button>
  </div>
</div>
